(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f003c664"],{"25f2":function(e,t,a){},"2fa2":function(e,t,a){"use strict";var r=a("25f2"),i=a.n(r);i.a},a15f:function(e,t,a){"use strict";var r=a("af17"),i=a.n(r);i.a},af17:function(e,t,a){},d301:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{"align-start":"",row:"",wrap:""}},[a("v-flex",{staticClass:"hidden-md-and-up",attrs:{xs12:""}},[a("v-tabs",{model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[a("v-tab",{key:"device"},[e._v("Device")]),a("v-tab",[e._v("Duration")]),a("v-tab",[e._v("Date")]),a("v-tab",[e._v("Result")])],1)],1),a("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.mdAndUp||0===e.currentTab,expression:"$vuetify.breakpoint.mdAndUp || currentTab === 0 "}],attrs:{xs12:"",md6:""}},[a("device-tree",{staticClass:"ma-1",attrs:{id:"rainfall-device-tree",items:e.deviceTreeItems,"selected-items":e.deviceTreeSelectedItems,"restore-items":e.deviceRestoreItems},on:{onsave:e.saveSelectionToStore,onrestore:e.restoreSelectionFromStore,onselectionupdate:e.onSelectionUpdate}})],1),a("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.mdAndUp||1===e.currentTab,expression:"$vuetify.breakpoint.mdAndUp || currentTab === 1"}],attrs:{xs12:"",md3:""}},[a("v-select",{staticClass:"ma-1",attrs:{items:e.durations,"item-text":"name",label:"Hours:","item-value":"duration",outline:""},model:{value:e.selectedDuration,callback:function(t){e.selectedDuration=t},expression:"selectedDuration"}})],1),a("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.mdAndUp||2===e.currentTab,expression:"$vuetify.breakpoint.mdAndUp || currentTab === 2"}],attrs:{xs12:"",md3:""}},[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[a("v-text-field",e._g({staticClass:"ma-1",attrs:{label:"Date:",outline:"",readonly:""},model:{value:e.datepicker,callback:function(t){e.datepicker=t},expression:"datepicker"}},r))]}}])},[a("v-date-picker",{on:{input:function(t){e.menu2=!1}},model:{value:e.datepicker,callback:function(t){e.datepicker=t},expression:"datepicker"}})],1)],1),a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-card",{staticClass:"my-1"},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-btn",{attrs:{color:"primary",disabled:!e.isvalid},on:{click:e.loadRainfallDataForDevices}},[e._v("Load Rainfall")]),a("v-btn",{attrs:{color:"primary",disabled:!e.isvalid},on:{click:e.loadRainfallDataForDevices}},[e._v("Reset")])],1),a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-layout",{attrs:{"align-center":"","justify-start":"",row:""}},[a("v-flex",{attrs:{shrink:""}},[a("v-checkbox",{staticClass:"ml-1 my-1 pa-0",attrs:{label:"Remember"},model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}})],1),a("v-flex",{attrs:{shrink:""}},[a("v-checkbox",{staticClass:"ml-2  my-1  pa-0",attrs:{label:"Auto-Load",disabled:!e.remember}})],1)],1)],1)],1)],1)],1),a("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.$vuetify.breakpoint.mdAndUp||3===e.currentTab,expression:"$vuetify.breakpoint.mdAndUp || currentTab === 3"}],attrs:{xs12:"","d-flex":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"","d-flex":""}},[e.loading&&!e.errorRequest?a("v-layout",{attrs:{"justify-center":"","align-center":"","pa-1":"","ma-1":""}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):e.loaded&e.errorRequest?a("v-layout",{attrs:{"justify-center":"","align-center":"","pa-1":"","ma-1":""}},[a("v-btn",{attrs:{color:"error"},on:{click:e.loadRainfallDataForDevices}},[e._v("Try Again")])],1):e.loaded?e._e():a("v-layout",[a("v-flex",{staticClass:"grey lighten-1",attrs:{xs12:""}},[a("h2",{staticClass:"grey--text text--darken-3 text-xs-center pa-3"},[e._v("Results Here")])])],1)],1),e.results.length>0?a("v-layout",{attrs:{row:"",wrap:""}},e._l(e.results,(function(e,t){return a("v-flex",{key:t,staticClass:"pt-3",attrs:{xs12:""}},[a("rainfall-region-result",{attrs:{results:e.results,region:e.name}})],1)})),1):e._e()],1)],1)],1)},i=[],n=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("2fa7")),s=a("c0d6"),o=a("2f62"),l=a("cc6d"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("region-result",{attrs:{results:e.results,region:e.region},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.device,r=e.chartWidth,i=e.chartHeight;return[a("rainfall-chart",{staticClass:"chart-container",attrs:{width:r,height:i,title:[t.tooltip,t.datetimeread+" -- "+t.raincumulative+" mm"],mydata:t.chart}})]}}])})},d=[],u=a("bdd7"),f=a("1fca"),v=a("30ef"),m=a.n(v),h=a("c1df"),p=a.n(h);m.a.Tooltip.positioners.cursor=function(e,t){return t};var b,x,y={extends:f["a"],mixins:[f["d"]],name:"RainfallChart",props:["mydata","dev_id","title"],mounted:function(){this.loadrainchart(this.mydata),this.lastbreakpoint=this.breakpoint},computed:{breakpoint:function(){return this.$vuetify.breakpoint.name}},data:function(){return{chartdata:{dataset:[]},options:{title:{display:!0,text:this.title},responsive:!1,maintainAspectRatio:!1,layout:{padding:10},scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"minute"},ticks:{source:"auto",autoSkip:!0,maxRotation:0,autoSkipPadding:20}}],yAxes:[{position:"left",id:"y-axis-1",ticks:{min:0,max:50}},{ticks:{min:0,suggestedMax:300,reverse:!0},position:"right",id:"y-axis-2",gridLines:{drawOnChartArea:!1}}]},tooltips:{mode:"index",position:"cursor",intersect:!1},plugins:{crosshair:{sync:{enabled:!1},zoom:{enabled:!1}}}},lastbreakpoint:""}},methods:{loadrainchart:function(e){var t=[],a=[];e.forEach((function(e){var r=p()(e[0],"YYYY-MM-DD HH:mm:ss");t.push({t:r.valueOf(),y:e[1]}),a.push({t:r.valueOf(),y:e[2]})})),this.chartdata={datasets:[{label:"Rainfall (mm)",backgroundColor:"rgb(255,139,137)",borderColor:"#F44336",borderWidth:1,data:t,lineTension:0,yAxisID:"y-axis-1"},{label:"Cumulative Rainfall (mm)",backgroundColor:"#8ad0ff",borderColor:"#1464f4",borderWidth:1,fill:!1,type:"line",lineTension:0,pointRadius:1,data:a,yAxisID:"y-axis-2"}]},this.renderChart(this.chartdata,this.options)}},watch:{breakpoint:function(e,t){var a=this;this.lastbreakpoint!==e&&(this.lastbreakpoint=e,this._data._chart.destroy(),this.$nextTick((function(){a.renderChart(a.chartdata,a.options)})))}}},g=y,k=a("2877"),R=Object(k["a"])(g,b,x,!1,null,null,null),D=R.exports,w={name:"RainfallRegionResult",props:["results","region"],components:{RegionResult:u["a"],RainfallChart:D}},T=w,C=(a("2fa2"),Object(k["a"])(T,c,d,!1,null,null,null)),O=C.exports,S=a("d722"),j=a("a766");function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(a,!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var A={name:"Rainfall",components:{DeviceTree:l["a"],RainfallRegionResult:O},mixins:[j["c"]],computed:I({},Object(o["b"])(["getRainfallSavedSelectedItems"]),{isvalid:function(){return this.selectedDevID.length>0}}),created:function(){console.log("created Rainfall"),this.loadRainfallDeviceTree(this.regCode)},data:function(){return{deviceTreeItems:[],deviceTreeSelectedItems:[],deviceRestoreItems:[],selectedDevID:[],selectedDuration:1440,durations:[{name:"1 hour",duration:60},{name:"3 hours",duration:180},{name:"6 hours",duration:360},{name:"12 hours",duration:720},{name:"24 hours",duration:1440}],datepicker:(new Date).toISOString().substr(0,10),loading:!1,loaded:!1,errorRequest:!1,results:[],currentTab:0,remember:!1,autoload:!1}},methods:{loadRainfallDeviceTree:function(e){var t,a=this;s["a"].commit("showLoader"),s["a"].commit("clearErrors"),console.log("fetching rainfall devices for regCode ".concat(e)),t="V"===e?Object(S["u"])():Object(S["v"])(e),t.then((function(e){s["a"].commit("hideLoader"),a.deviceTreeSelectedItems=[],a.deviceTreeItems=e.data})).catch((function(e){s["a"].commit("hideLoader"),s["a"].commit("setErrors",["Cannot connect to server. Please try again."])}))},saveSelectionToStore:function(e){var t={regCode:this.regCode,items:e};s["a"].commit("setRainfallSavedSelectedDevices",t)},restoreSelectionFromStore:function(){var e=this;this.deviceRestoreItems=this.getRainfallSavedSelectedItems(this.regCode),this.$nextTick().then((function(){e.deviceRestoreItems=[]}))},onSelectionUpdate:function(e){this.selectedDevID=e},loadRainfallDataForDevices:function(){var e=this;this.loading=!0,this.errorRequest=!1,this.currentTab=3,Object(S["t"])(this.selectedDevID,this.selectedDuration).then((function(t){e.loading=!1,e.results=[],e.loaded=!0,e.$nextTick((function(){var a=t.data;Object.keys(a).forEach((function(t){console.log(t);var r={name:t,results:e.extractResultArr(a[t])};console.log(r),e.results.push(r)}))}))})).catch((function(t){e.loading=!1,e.loaded=!0,e.errorRequest=!0}))},extractResultArr:function(e){var t=[];return Object.keys(e).forEach((function(a){var r={header:a,charts:[]},i=e[a];Object.keys(i).forEach((function(e){var t=i[e];t.forEach((function(e){r.charts.push(e)}))})),t.push(r)})),t},onRegCodeChange:function(){console.log("Rainfall.vue onRegCodeChange()"),this.deviceTreeItems=[],this.results=[],this.loadRainfallDeviceTree(this.regCode)}},watch:{currentTab:function(e,t){console.log(e)}}},$=A,V=(a("a15f"),a("6544")),P=a.n(V),E=a("8336"),U=a("b0af"),F=a("ac7c"),L=a("2e4b"),q=a("0e8f"),H=a("a722"),M=a("e449"),N=a("490a"),Y=a("b56d"),W=a("71a3"),J=a("fe57"),z=a("2677"),B=Object(k["a"])($,r,i,!1,null,"70c8249c",null);t["default"]=B.exports;P()(B,{VBtn:E["a"],VCard:U["a"],VCheckbox:F["a"],VDatePicker:L["a"],VFlex:q["a"],VLayout:H["a"],VMenu:M["a"],VProgressCircular:N["a"],VSelect:Y["a"],VTab:W["a"],VTabs:J["a"],VTextField:z["a"]})}}]);