(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-031ef914"],{"89be":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},["loaded"===e.loading||"nodata"===e.loading?a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("device-info",{attrs:{dev_id:e.device.dev_id,province:e.device.province,citymun:e.device.citymun,location:e.device.location,status:e.device.status},on:{updatedStatus:e.onUpdatedDeviceStatus}})],1):e._e(),"loading"===e.loading?a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-layout",{attrs:{"justify-center":"","align-center":"","pa-4":""}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1)],1):e._e(),"loaded"===e.loading?a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-card-text",{staticClass:"pt-0"},[a("v-layout",{staticStyle:{"max-height":"calc(90vh - 200px)"},attrs:{column:""}},[a("v-flex",{staticStyle:{overflow:"auto"},attrs:{xs12:""}},["last_data"===e.selectedView?a("device-data-peek",{attrs:{data:e.latest_response}}):"table"===e.selectedView?a("device-data-table",{attrs:{data:e.response,columns:e.columns}}):"rainfall"===e.selectedView?a("device-data-rainfall-chart",{attrs:{data:e.rainfall_response,title:e.title}}):"waterlevel"===e.selectedView?a("device-data-waterlevel-chart",{attrs:{data:e.waterlevel_response,title:e.title}}):"heat_index"===e.selectedView?a("device-data-heat-index-chart",{attrs:{data:e.heatindex_response,title:e.title}}):e._e()],1)],1)],1)],1):e._e(),"nodata"===e.loading?a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-container",{staticClass:"px-3 pb-3 pt-0 ma-0"},[a("h3",[e._v("No Data")])])],1):e._e(),"loaded"===e.loading||"nodata"===e.loading?a("v-flex",{attrs:{xs12:"","d-flex":""}},[a("v-card-actions",{staticClass:"grey lighten-3"},[a("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[a("v-flex",{attrs:{xs8:""}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-text-field",e._g({staticClass:"pa-0",staticStyle:{"min-width":"200px","max-width":"200px"},attrs:{value:e.computedDateFormattedMomentjs(e.selectedDate),"prepend-icon":"event",readonly:"",clearable:""},on:{"click:clear":e.onDateClear}},i))]}}],null,!1,4022347716),model:{value:e.menuDate,callback:function(t){e.menuDate=t},expression:"menuDate"}},[a("v-date-picker",{attrs:{max:e.maxDateWMO,"no-title":"",scrollable:""},on:{input:e.onDateInput},model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}})],1)],1),"loaded"===e.loading?a("v-flex",{staticClass:"text-xs-right",attrs:{xs4:""}},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedView,expression:"selectedView"}],staticClass:"primary white--text pa-1 text-xs-center",staticStyle:{"border-style":"solid"},attrs:{id:"selectedView"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedView=t.target.multiple?a:a[0]}}},e._l(e.viewSelection,(function(t){return a("option",{key:t.name,domProps:{value:t.value}},[e._v(e._s(t.name))])})),0)]):e._e()],1)],1)],1):e._e()],1)],1)},n=[],r=(a("99af"),a("caad"),a("d81d"),a("c1df")),s=a.n(r),o=a("c0d6"),l=a("d722"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},e._l(e.data,(function(t,i,n){return a("v-text-field",{key:i,attrs:{label:e.$_deviceColumnUnitMixin_withUnit(i),value:t,readonly:""}})})),1)],1)},d=[],u=a("a766"),v={name:"DeviceDataPeek",props:["data"],mixins:[u["b"]],created:function(){console.log("created DeviceDataPeek")},filters:{withUnit:function(e){var t=this.$_deviceColumnUnitMixin_getUnit(e);return""!==t?"".concat(e," (").concat(t,")"):e}}},h=v,m=a("2877"),p=a("6544"),f=a.n(p),_=a("0e8f"),D=a("a722"),x=a("2677"),g=Object(m["a"])(h,c,d,!1,null,"5822e5a1",null),b=g.exports;f()(g,{VFlex:_["a"],VLayout:D["a"],VTextField:x["a"]});var w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"elevation-1 pa-0 ma-0",attrs:{headers:e.headers,items:e.data,"rows-per-page-items":e.rowsPerPageItems,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.columns,(function(i){return a("td",[e._v(e._s(t.item[i]))])}))}}])})},y=[],C={name:"DeviceDataTable",props:["data","columns"],mixins:[u["b"]],created:function(){console.log("created DeviceDatatable")},computed:{headers:function(){var e=this,t=[];return t=this.columns.map((function(t){var a=e.$_deviceColumnUnitMixin_getUnit(t);return{text:""!==a?"".concat(t," (").concat(a,")"):t,value:t,align:"left"}})),t}},data:function(){return{rowsPerPageItems:[10,20,30,40,{text:"All",value:-1}],pagination:{rowsPerPage:10,sortBy:"Datetime Read",descending:!0}}}},M=C,O=(a("b27b"),a("8fea")),R=Object(m["a"])(M,w,y,!1,null,"401e27a1",null),V=R.exports;f()(R,{VDataTable:O["a"]});a("acd8"),a("159b");var S,k,T,A,I,j,P=a("1fca"),$=a("bbf4"),W={extends:P["a"],name:"DeviceDataRainfallChart",props:["data","title"],mixins:[$["b"]],mounted:function(){console.log("created DeviceDataRainfallChart"),this.loadrainchart()},methods:{loadrainchart:function(){var e=[],t=[];this.data.forEach((function(a){var i=s()(a["Datetime Read"],"YYYY-MM-DD HH:mm:ss");e.push({t:i.valueOf(),y:parseFloat(a["Rainfall Amount"])}),t.push({t:i.valueOf(),y:parseFloat(a["Rain Cumulative"])})})),this.$_rainfallChartMixin_setRainfall(e),this.$_rainfallChartMixin_setRainCumulative(t);var a="[NODATA]",i=this.data.length;i>0&&(a=this.data[i-1]["Datetime Read"]+" -- "+this.data[i-1]["Rain Cumulative"]+" mm");var n=[this.title,a];this.$_rainfallChartMixin_setTitle(n),this.$_rainfallChartMixin_render()}},watch:{data:function(e,t){console.log("data updated"),this.loadrainchart()}}},U=W,Y=Object(m["a"])(U,S,k,!1,null,"7e5e3d58",null),H=Y.exports,E={extends:P["c"],name:"DeviceDataWaterlevelChart",props:["data","title"],mixins:[$["c"]],mounted:function(){this.loadwaterlevelchart()},methods:{loadwaterlevelchart:function(){var e=this.data.map((function(e){var t=s()(e["Datetime Read"],"YYYY-MM-DD HH:mm:ss");return{t:t.valueOf(),y:parseFloat(e["Waterlevel"])}}));this.$_waterlevelChartMixin_setWaterlevel(e);var t="[NODATA]",a=this.data.length;a>0&&(t=this.data[a-1]["Datetime Read"]+" -- "+this.data[a-1]["Waterlevel"]+" m");var i=[this.title,t];this.$_waterlevelChartMixin_setTitle(i),this.$_waterlevelChartMixin_render()}},watch:{data:function(e,t){console.log("data updated"),this.loadwaterlevelchart()}}},L=E,F=Object(m["a"])(L,T,A,!1,null,"60beb464",null),N=F.exports,B=(a("e25e"),{extends:P["c"],name:"DeviceDataHeatIndex",mixins:[$["a"]],props:["data","title"],mounted:function(){this.loadheatindexchart()},methods:{loadheatindexchart:function(){var e=[],t=[];this.data.forEach((function(a){var i=s()(a["Datetime Read"],"YYYY-MM-DD HH:mm:ss");e.push({t:i.valueOf(),y:parseFloat(a["Air Temperature"])}),t.push({t:i.valueOf(),y:parseInt(a["Heat Index"])})})),this.$_heatIndexChartMixin_setTemperature(e),this.$_heatIndexChartMixin_setHeatIndex(t);var a="[NODATA]",i=this.data.length;i>0&&(a=this.data[i-1]["Datetime Read"]+" -- "+this.data[i-1]["Air Temperature"]+" / "+this.data[i-1]["Heat Index"]+" Â°C");var n=[this.title,a];this.$_heatIndexChartMixin_setTitle(n),this.$_heatIndexChartMixin_render()}},watch:{data:function(e,t){console.log("data updated"),this.loadheatindexchart()}}}),z=B,J=Object(m["a"])(z,I,j,!1,null,"425d5a94",null),G=J.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card-title",{staticClass:"pb-1",attrs:{"primary-title":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{grow:""}},[a("h3",{staticClass:"mb-0"},[e._v(e._s(e.citymun)+" - "+e._s(e.province)+" ("+e._s(e.dev_id)+")")]),a("div",[e._v(" "+e._s(e.location))])]),a("v-flex",{attrs:{shrink:""}},[e.loading?a("div",[a("v-chip",{attrs:{"text-color":"white",small:""}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"18",color:"secondary"}})],1)],1):a("div",[0===e.selectedStatus||e.selectionMode?a("v-chip",{attrs:{color:"green","text-color":"white",small:""},on:{click:function(t){return e.onToggle(0)}}},[e._v(" Enabled "),a("v-icon",{attrs:{right:""}},[e._v("check_circle")])],1):e._e(),1===e.selectedStatus||e.selectionMode?a("v-chip",{attrs:{color:"red darken-1","text-color":"white",small:""},on:{click:function(t){return e.onToggle(1)}}},[e._v(" Disabled "),a("v-icon",{attrs:{right:""}},[e._v("error")])],1):e._e(),2===e.selectedStatus||e.selectionMode?a("v-chip",{attrs:{color:"red darken-1","text-color":"white",small:""},on:{click:function(t){return e.onToggle(2)}}},[e._v(" Disabled Rain "),a("v-icon",{attrs:{right:""}},[e._v("error")])],1):e._e(),3===e.selectedStatus||e.selectionMode?a("v-chip",{attrs:{color:"red darken-1","text-color":"white",small:""},on:{click:function(t){return e.onToggle(3)}}},[e._v(" Disabled Water Level "),a("v-icon",{attrs:{right:""}},[e._v("error")])],1):e._e()],1)])],1)],1)],1)},K=[],Q=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("2532"),a("2fa7")),X=a("2f62");function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(a,!0).forEach((function(t){Object(Q["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var te={created:function(){console.log("permissionsMixin")},computed:ee({},Object(X["b"])(["userPermissions"])),methods:{$__permissionsMixin_canUpdateDeviceInfo:function(){return this.userPermissions.includes("device-update-status")}}},ae={name:"DeviceInfo",props:["dev_id","province","citymun","location","status"],mixins:[te],created:function(){console.log("created DeviceInfo"),this.selectedStatus=this.status},data:function(){return{selectedStatus:-1,selectionMode:!1,loading:!1}},methods:{onToggle:function(e){var t=this;if(!this.$__permissionsMixin_canUpdateDeviceInfo())return!1;this.selectionMode?(this.loading=!0,this.$nextTick((function(){Object(l["G"])(t.dev_id,e).then((function(a){a.data.success&&(t.selectedStatus=e,t.$emit("updatedStatus",{dev_id:t.dev_id,status:e}))})).catch((function(e){console.log(e)})),t.loading=!1,t.selectionMode=!1}))):this.selectionMode=!0}}},ie=ae,ne=a("12b2"),re=a("cc20"),se=a("132d"),oe=a("490a"),le=Object(m["a"])(ie,q,K,!1,null,"d17b7b16",null),ce=le.exports;f()(le,{VCardTitle:ne["a"],VChip:re["a"],VFlex:_["a"],VIcon:se["a"],VLayout:D["a"],VProgressCircular:oe["a"]});var de=a("0261"),ue={name:"DeviceDataLatest",props:["dev_id"],mixins:[de["a"]],components:{DeviceDataPeek:b,DeviceDataTable:V,DeviceDataRainfallChart:H,DeviceDataWaterlevelChart:N,DeviceDataHeatIndexChart:G,DeviceInfo:ce},created:function(){var e=this;console.log("created DeviceView"),this.selectedDate=o["a"].getters.getDevicesLastDate,Object(l["e"])(this.dev_id).then((function(t){o["a"].commit("clearErrors"),e.device.dev_id=t.data.dev_id,e.device.citymun=t.data.citymun_desc,e.device.province=t.data.province_desc,e.device.location=t.data.locationDesc,e.device.status=t.data.status,e.device.type_name=t.data.type_name,e.title="".concat(e.device.citymun," - ").concat(e.device.location," (").concat(e.device.dev_id,")"),e.loadDeviceData()})).catch((function(){o["a"].commit("setErrors",["Cannot connect to server. Please try again."]),e.$emit("error-loading")}))},computed:{viewSelection:function(){var e=[{name:"Last Data",icon:"remove_red_eye",color:"primary",value:"last_data"},{name:"Table",icon:"table_chart",color:"amber",value:"table"}];return["VAISALA","Rain1","Rain2","Waterlevel & Rain 2","UAAWS","BSWM_Lufft","Davis"].includes(this.device.type_name)&&e.push({name:"Rainfall",icon:"cloud",color:"green",value:"rainfall"}),["Waterlevel","Waterlevel & Rain 2"].includes(this.device.type_name)&&e.push({name:"Waterlevel",icon:"waves",color:"blue",value:"waterlevel"}),["VAISALA","UAAWS","BSWM_Lufft","Davis"].includes(this.device.type_name)&&e.push({name:"Heat Index",icon:"ac_unit",color:"purple",value:"heat_index"}),e},latest_response:function(){var e=this.response.length;return"Datetime Read"in this.response[e-1]?this.response[e-1]:"dateTimeRead"in this.response[0]?this.response[0]:void 0},rainfall_response:function(){return this.response.map((function(e){return{"Datetime Read":e["Datetime Read"],"Rainfall Amount":e["Rainfall Amount"],"Rain Cumulative":e["Rain Cumulative"]}}))},waterlevel_response:function(){return this.response.map((function(e){return{"Datetime Read":e["Datetime Read"],Waterlevel:e["Waterlevel"]}}))},heatindex_response:function(){return this.response.map((function(e){return{"Datetime Read":e["Datetime Read"],"Air Temperature":e["Air Temperature"],"Heat Index":e["Heat Index"]}}))}},data:function(){return{device:{dev_id:0,citymun:"",province:"",location:"",status:0,type_name:""},loading:"loading",response:[],columns:[],title:"",selectedView:"last_data",menuDate:"",selectedDate:""}},methods:{computedDateFormattedMomentjs:function(e){return e?s()(e).format("MMMM DD, YYYY"):""},loadDeviceData:function(){var e,t=this;e=""===this.selectedDate||this.selectedDate===this.nowDateISOStr?Object(l["w"])(this.dev_id):Object(l["c"])(this.dev_id,this.selectedDate),e.then((function(e){o["a"].commit("clearErrors");var a=e.data.Data.length;0!==a&&("Datetime Read"in e.data.Data[a-1]||"dateTimeRead"in e.data.Data[0])?(t.response=e.data.Data,t.columns=e.data.Columns,t.loading="loaded"):t.loading="nodata"})).catch((function(e){o["a"].commit("setErrors",["Cannot connect to server. Please try again."]),t.$emit("error-loading")}))},onDateClear:function(){console.log("onDateClear"),this.selectedDate=""},onDateInput:function(e){this.menuDate=!1,console.log(e)},onUpdatedDeviceStatus:function(e){console.log("onUpdatedDeviceStatus"),this.$emit("deviceUpdatedStatus",e)}},watch:{selectedDate:function(e,t){console.log("selectedDate Updating ".concat(t," ---to--- ").concat(e)),e!==o["a"].getters.getDevicesLastDate&&(o["a"].commit("setDevicesLastDate",e),this.loadDeviceData())}}},ve=ue,he=a("b0af"),me=a("99d9"),pe=a("a523"),fe=a("2e4b"),_e=a("e449"),De=Object(m["a"])(ve,i,n,!1,null,"fbc806ee",null);t["default"]=De.exports;f()(De,{VCard:he["a"],VCardActions:me["a"],VCardText:me["b"],VContainer:pe["a"],VDatePicker:fe["a"],VFlex:_["a"],VLayout:D["a"],VMenu:_e["a"],VProgressCircular:oe["a"],VTextField:x["a"]})},b27b:function(e,t,a){"use strict";var i=a("d52c"),n=a.n(i);n.a},d52c:function(e,t,a){}}]);