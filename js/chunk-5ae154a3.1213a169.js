(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ae154a3"],{"02d0":function(e,t,r){"use strict";var a=r("3b77"),n=r.n(a);n.a},2962:function(e,t,r){},3177:function(e,t,r){"use strict";r.r(t);var a,n,o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-expansion-panel",{attrs:{expand:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[r("v-expansion-panel-content",{scopedSlots:e._u([{key:"header",fn:function(){return[r("h3",[e._v("Select device: ")])]},proxy:!0}])},[r("device-tree",{staticClass:"ma-1",attrs:{id:"waterlevel-device-tree",items:e.deviceTreeItems,"selected-items":e.deviceTreeSelectedItems,"restore-items":e.deviceRestoreItems},on:{onsave:e.saveSelectionToStore,onrestore:e.restoreSelectionFromStore,onselectionupdate:e.onSelectionUpdate}})],1),r("v-expansion-panel-content",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],scopedSlots:e._u([{key:"header",fn:function(){return[r("h3",[e._v("Select date: ")])]},proxy:!0}])},[r("v-date-picker",{staticClass:"ma-1",attrs:{reactive:!0,landscape:!0},model:{value:e.datepicker,callback:function(t){e.datepicker=t},expression:"datepicker"}})],1),r("v-expansion-panel-content",{staticClass:"grey lighten-2",scopedSlots:e._u([{key:"header",fn:function(){return[r("h3",[e._v("Actions: ")])]},proxy:!0}])},[r("div",[r("v-btn",{attrs:{color:"primary",disabled:!e.isvalid},on:{click:e.loadWaterlevelDataForDevices}},[e._v("Load Waterlevel\n\t\t\t\t\t")])],1)])],1)],1),r("v-flex",{attrs:{xs12:"","d-flex":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"","d-flex":""}},[e.loading&&!e.errorRequest?r("v-layout",{attrs:{"justify-center":"","align-center":"","pa-1":"","ma-1":""}},[r("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):e.errorRequest?r("v-layout",{attrs:{"justify-center":"","align-center":"","pa-1":"","ma-1":""}},[r("v-btn",{attrs:{color:"error"},on:{click:e.loadWaterlevelDataForDevices}},[e._v("Try Again")])],1):e._e()],1),e.results.length>0?r("v-layout",{attrs:{row:"",wrap:""}},e._l(e.results,function(e,t){return r("v-flex",{key:t,staticClass:"pt-3",attrs:{xs12:""}},[r("waterlevel-region-result",{attrs:{results:e.results,region:e.name}})],1)}),1):e._e()],1)],1)],1)},s=[],i=(r("8e6e"),r("456d"),r("ac6a"),r("bd86")),c=r("c0d6"),l=r("2f62"),d=r("cc6d"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("region-result",{attrs:{results:e.results,region:e.region},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.device,a=e.chartWidth,n=e.chartHeight;return[r("waterlevel-chart",{staticClass:"chart-container",attrs:{width:a,height:n,title:[t.tooltip,t.datetimeread+" -- "+t.waterlevel/100+" m"],mydata:t.chart}})]}}])})},v=[],h=r("bdd7"),p=r("1fca"),f=r("c1df"),m=r.n(f),g={name:"WaterlevelChart",extends:p["c"],props:["mydata","title"],mounted:function(){this.loadwaterlevelchart(this.mydata),this.lastbreakpoint=this.breakpoint},computed:{breakpoint:function(){return this.$vuetify.breakpoint.name}},data:function(){return{chartdata:{datasets:[]},options:{title:{display:!0,text:this.title},responsive:!1,maintainAspectRatio:!1,layout:{padding:10},scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"hour",displayFormats:{hour:"HH:mm"}}}],yAxes:[{ticks:{min:0,suggestedMax:12}}]}},lastbreakpoint:""}},methods:{loadwaterlevelchart:function(e){var t=[];e.forEach(function(e){var r=m()(e[0],"YYYY-MM-DD HH:mm:ss");t.push({t:r.valueOf(),y:(e[1]/100).toFixed(2)})}),this.chartdata={datasets:[{label:"Waterlevel (m)",backgroundColor:"#8ad0ff",borderColor:"#1464f4",borderWidth:1,pointRadius:0,fill:"start",data:t}]},this.renderChart(this.chartdata,this.options)}},watch:{breakpoint:function(e,t){var r=this;this.lastbreakpoint!==e&&(this.lastbreakpoint=e,this._data._chart.destroy(),this.$nextTick(function(){r.renderChart(r.chartdata,r.options)}))}}},b=g,y=r("2877"),x=Object(y["a"])(b,a,n,!1,null,null,null),k=x.exports,w={name:"WaterlevelRegionResult",props:["results","region"],components:{RegionResult:h["a"],WaterlevelChart:k}},S=w,O=(r("02d0"),Object(y["a"])(S,u,v,!1,null,null,null)),D=O.exports,C=r("a766"),j=r("d722");function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(r,!0).forEach(function(t){Object(i["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var I={name:"Waterlevel",components:{DeviceTree:d["a"],WaterlevelRegionResult:D},mixins:[C["c"]],computed:W({},Object(l["b"])(["getWaterlevelSavedSelectedItems"]),{isvalid:function(){return this.selectedDevID.length>0}}),created:function(){console.log("created Waterlevel"),this.loadWaterlevelDeviceTree(this.regCode)},data:function(){return{panel:[!1,!1,!0],deviceTreeItems:[],deviceTreeSelectedItems:[],deviceRestoreItems:[],selectedDevID:[],datepicker:(new Date).toISOString().substr(0,10),loading:!1,errorRequest:!1,results:[]}},methods:{loadWaterlevelDeviceTree:function(e){var t,r=this;c["a"].commit("showLoader"),c["a"].commit("clearErrors"),console.log("fetching waterlevel devices for regCode ".concat(e)),t="V"===e?Object(j["y"])():Object(j["z"])(e),t.then(function(e){c["a"].commit("hideLoader"),r.deviceTreeSelectedItems=[],r.deviceTreeItems=e.data,r.panel=[!0,!1,!0]}).catch(function(e){c["a"].commit("hideLoader"),c["a"].commit("setErrors",["Cannot connect to server. Please try again."])})},saveSelectionToStore:function(e){var t={regCode:regCode,items:e};c["a"].commit("setWaterlevelSavedSelectedDevices",t)},restoreSelectionFromStore:function(){var e=this;this.deviceRestoreItems=this.getWaterlevelSavedSelectedItems(this.regCode),this.$nextTick().then(function(){e.deviceRestoreItems=[]})},onSelectionUpdate:function(e){this.selectedDevID=e},loadWaterlevelDataForDevices:function(){var e=this;this.loading=!0,this.errorRequest=!1,this.panel=[!1,!1,!0],Object(j["x"])(this.selectedDevID).then(function(t){e.loading=!1,e.results=[],e.$nextTick(function(){var r=t.data;Object.keys(r).forEach(function(t){console.log(t);var a={name:t,results:e.extractResultArr(r[t])};console.log(a),e.results.push(a)})})}).catch(function(t){e.loading=!1,e.errorRequest=!0})},extractResultArr:function(e){var t=[];return Object.keys(e).forEach(function(r){var a={header:r,charts:[]},n=e[r];Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(e){a.charts.push(e)})}),t.push(a)}),t},onRegCodeChange:function(){console.log("Waterlevel.vue onRegCodeChange()"),this.deviceTreeItems=[],this.results=[],this.loadWaterlevelDeviceTree(this.regCode)}}},_=I,T=(r("977d"),r("6544")),E=r.n(T),P=r("8336"),F=r("2e4b"),V=r("cd55"),A=r("49e2"),$=r("0e8f"),q=r("a722"),H=r("490a"),L=Object(y["a"])(_,o,s,!1,null,"209dac78",null);t["default"]=L.exports;E()(L,{VBtn:P["a"],VDatePicker:F["a"],VExpansionPanel:V["a"],VExpansionPanelContent:A["a"],VFlex:$["a"],VLayout:q["a"],VProgressCircular:H["a"]})},"3b77":function(e,t,r){},"977d":function(e,t,r){"use strict";var a=r("2962"),n=r.n(a);n.a}}]);